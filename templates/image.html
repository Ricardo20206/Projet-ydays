{% extends "base.html" %}

{% block content %}
<script>
    window.currentMedia = {
        video: null,
        image: {{ image|default('null')|tojson }}
    };
</script>
<div class="page-content">
    <h1 style="color: #2a2a2a; margin-bottom: 15px;">ğŸ–¼ï¸ Gestion des Images</h1>
    
    <form class="upload-form" action="/upload" method="POST" enctype="multipart/form-data">
        <input type="file" name="file" accept="image/*" required>
        <button type="submit">ğŸ“¤ Charger une image</button>
    </form>
    
    {% if image %}
    <div class="media-container">
        <img src="{{ url_for('serve_image', filename=image) }}" alt="Image uploadÃ©e">
    </div>
    
    <div style="margin-top: 10px; text-align: center;">
        <button class="delete-btn" onclick="deleteFile('{{ image }}')">ğŸ—‘ Supprimer l'image</button>
    </div>
    
    {% if processed_image %}
    <div class="info-section" style="margin-top: 15px;">
        <h4>âœ… Image traitÃ©e disponible :</h4>
        <div class="media-container">
            <img src="{{ url_for('serve_image', filename=processed_image) }}" alt="Image traitÃ©e">
        </div>
        <div style="text-align: center; margin-top: 15px;">
            <a href="{{ url_for('serve_image', filename=processed_image) }}" download style="color: #4a90e2; text-decoration: none; font-weight: 500;">
                ğŸ“¥ TÃ©lÃ©charger l'image traitÃ©e
            </a>
        </div>
    </div>
    {% endif %}
    {% endif %}
</div>

<script>
function deleteFile(filename) {
    if (confirm('ÃŠtes-vous sÃ»r de vouloir supprimer cette image ?')) {
        fetch("/delete/" + filename, {
            method: "POST"
        })
        .then(() => {
            location.reload();
        });
    }
}
</script>
{% endblock %}
